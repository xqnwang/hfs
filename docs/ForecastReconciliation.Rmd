---
title: "Forecast Reconciliation"
author: "Xiaoqian Wang"
date: '2023-01-10'
output: 
  pdf_document:
    number_sections: true
linestretch: 1.5
fontsize: 11pt
mainfont: "Times New Roman"
monofont: "Monaco"
geometry: a4paper, margin=20mm
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Review Paper

## Typos

In section 3.3 - Computational and theoretical developments:

* The WLS solution
    + $\boldsymbol{G}=\left(\boldsymbol{S}^{\prime} \boldsymbol{\Lambda}_h^{-1} \boldsymbol{S}\right)^{-1} \boldsymbol{S}^{\prime} \boldsymbol{\Lambda}_h^{-1}$ rather than $\boldsymbol{G}=\boldsymbol{S}\left(\boldsymbol{S}^{\prime} \boldsymbol{\Lambda}_h^{-1} \boldsymbol{S}\right)^{-1} \boldsymbol{\Lambda}_h^{-1} \boldsymbol{S}$

* The MinT solution
    + $\boldsymbol{G}=\left(\boldsymbol{S}^{\prime} \boldsymbol{W}_h^{-1} \boldsymbol{S}\right)^{-1} \boldsymbol{S}^{\prime} \boldsymbol{W}_h^{-1}$ rather than $\boldsymbol{G}=\left(\boldsymbol{S}^{\prime} \boldsymbol{W}_h^{-1} \boldsymbol{S}\right)^{-1} \boldsymbol{W}_h^{-1} \boldsymbol{S}$
    + $\boldsymbol{M}=\boldsymbol{S} \left(\boldsymbol{S}^{\prime} \boldsymbol{W}_h^{-1} \boldsymbol{S}\right)^{-1} \boldsymbol{S}^{\prime} \boldsymbol{W}_h^{-1}$ rather than $\boldsymbol{M}= \boldsymbol{S} \left(\boldsymbol{S}^{\prime} \boldsymbol{W}_h^{-1} \boldsymbol{S}\right)^{-1} \boldsymbol{W}_h^{-1} \boldsymbol{S}$

## Notation

Equation (1): $\tilde{\boldsymbol{y}}_h=\boldsymbol{S} \boldsymbol{G} \hat{\boldsymbol{y}}_h$.

* $\boldsymbol{G}$ varies across forecast horizons, why not use $\boldsymbol{G}_h$?

* It may be better to discuss more about the implications of $\boldsymbol{G}$. For example, $\boldsymbol{G}$ maps the base forecasts $\hat{\boldsymbol{y}}_h$ into the bottom level and can be thought of as a forecast combination that combines all base forecasts $\hat{\boldsymbol{y}}_h$ if all the columns of $\boldsymbol{G}$ are non-zero. Also, there are zero-columns in the $\boldsymbol{G}$ matrix for single-level approaches.

In section 3.4 - Optimization approaches:

* Ben Taieb & Koo (2019)
    + $L_T(\boldsymbol{G})=\frac{1}{N n}\left\|\boldsymbol{Y}-\hat{\boldsymbol{Y}} \boldsymbol{G}^{\prime} \boldsymbol{S}^{\prime}\right\|_F+\lambda\|\operatorname{vec} \boldsymbol{G}\|_1$, where $N = T-T_{1}-h+1$.
    + The implications of the $L_T(\boldsymbol{G})$ definition  are not very clear.

## Other concerns

* Do section 3.3 (computational and theoretical developments) and section 3.4 (optimization approaches) overlap? Because MinT can also be regarded as an optimization approach.

* Should the heading of section 3.5 be changed to "Optimization approaches with practical constraints"? As stated at the beginning of section 3.5, "Any approach to reconciliation based on optimisation, in some sense uses constrained optimisation since reconciled forecasts must lie on the coherent subspace."

* In section 3.5, perhaps Kourentzes & Athanasopoulos (2021) should follow immediately after the first paragraph discussing non-negativity constraints.


# Subset selection

For a hierarchical forecasting problem.

1. Create a hierarchical structure as complete as possible. Then the base forecasts $\hat{\boldsymbol{y}}_h$ and the summing matrix $\boldsymbol{S}$ is given.

![A 2-level hierarchical tree structure](figs/hs.png){width=20%}

$$
\boldsymbol{S}=\left[\begin{array}{llllll}
1 & 1 & 1 & 1 & 1 \\
1 & 1 & 1 & 0 & 0 \\
0 & 0 & 0 & 1 & 1 \\
1 & 0 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 & 0 \\
0 & 0 & 1 & 0 & 0 \\
0 & 0 & 0 & 1 & 0 \\
0 & 0 & 0 & 0 & 1 \\
\end{array}\right]
$$

2. Forecast reconciliation $\tilde{\boldsymbol{y}}_h=\boldsymbol{S} \boldsymbol{G} \hat{\boldsymbol{y}}_h$.
    + There are zero-columns in the $\boldsymbol{G}$ matrix for single-level approaches.
    + As long as all the columns of $\boldsymbol{G}$ are non-zero, it uses all $\hat{\boldsymbol{y}}_h$ information to obtain the updated bottom-level forecasts.
    
3. Subset selection
    + columns of $\boldsymbol{G}$ & rows of $\boldsymbol{S}$
    + forecast evaluation


